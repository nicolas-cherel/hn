montageDefine("fbef3d3","ui/story-list.reel/story-list",{dependencies:["montage/ui/component","firebase","lib/time-ago-converter"],factory:function(e,t){var n=e("montage/ui/component").Component,i=e("firebase"),o=e("lib/time-ago-converter").TimeAgoConverter;t.StoryList=n.specialize({constructor:{value:function(){this.super()}},loadNextStories:{value:function(){var e=new i("https://hacker-news.firebaseio.com/v0/topstories"),t=this,n=e.on("value",function(o){var r=[];o.val().slice(t.subs.length,t.subs.length+50).forEach(function(e){var t=new i("https://hacker-news.firebaseio.com/v0/item/"+e);(function(e){r.push(new Promise(function(t){var n=e.on("value",function(i){t(i.val()),e.off("value",n)})}))})(t)}),Promise.all(r).then(function(i){i.forEach(function(e){t.subs.push(e)}),e.off("value",n)})})}},templateDidLoad:{value:function(){this.loadNextStories()}},time_ago_converter:{value:new o},subs:{value:[]},handleClick:{value:function(e){e.target.component&&"story-more-link"===e.target.component.identifier&&(this.loadNextStories(),e.stopPropagation(),e.preventDefault())}},enterDocument:{value:function(e){e&&this.element.addEventListener("click",this,!1)}}})}});